create or replace PROCEDURE PRC_VALIDA_LOC (
P_ID_PRODUTO NUMBER,
P_QUANTIDADE_PEDIDO NUMBER,
P_DATA_LOC DATE
)IS
V_NOME_PRODUTO VARCHAR(40);
V_VALOR_PRODUTO NUMBER;
V_QUANTIDADE_LOCADO NUMBER;
V_QUANTIDADE_ESTOQUE NUMBER;
V_DATA_DEVOLUCAO DATE;

BEGIN

SELECT NOME_PRODUTO
INTO V_NOME_PRODUTO
FROM TB_PRODUTOS
WHERE ID_PRODUTO = P_ID_PRODUTO;

SELECT VALOR_PRODUTO
INTO V_VALOR_PRODUTO
FROM TB_PRODUTOS
WHERE ID_PRODUTO = P_ID_PRODUTO;

SELECT SUM(QUANTIDADE_PEDIDO)
INTO V_QUANTIDADE_LOCADO
FROM TB_LOCACAO_PRODUTOS
WHERE ID_PRODUTO = P_ID_PRODUTO;

SELECT QUANTIDADE_PRODUTO
INTO V_QUANTIDADE_ESTOQUE
FROM TB_PRODUTOS
WHERE ID_PRODUTO = P_ID_PRODUTO;

SELECT MIN(DATA_DEVOLUCAO)
INTO V_DATA_DEVOLUCAO
FROM TB_LOCACAO_PRODUTOS;

IF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND

         P_ID_PRODUTO = 1 THEN
            IF P_QUANTIDADE_PEDIDO > 20 THEN
                DBMS_OUTPUT.PUT_LINE('TEMOS UM LIMITE DE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO|| ' PRODUTOS');

            END IF;
ELSIF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND

         P_ID_PRODUTO = 2 THEN
            IF P_QUANTIDADE_PEDIDO > 140 THEN
                DBMS_OUTPUT.PUT_LINE('TEMOS UM LIMITE DE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO|| ' PRODUTOS');
            END IF;

ELSIF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND

         P_ID_PRODUTO = 3 THEN
            IF P_QUANTIDADE_PEDIDO > 20 THEN
                DBMS_OUTPUT.PUT_LINE('TEMOS UM LIMITE DE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO|| ' PRODUTOS');
            END IF;

ELSIF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND

         P_ID_PRODUTO = 4 THEN
            IF P_QUANTIDADE_PEDIDO > 2 THEN
                DBMS_OUTPUT.PUT_LINE('TEMOS UM LIMITE DE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO|| ' PRODUTOS');
            END IF;

ELSIF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND

         P_ID_PRODUTO = 5 THEN
            IF P_QUANTIDADE_PEDIDO > 3 THEN
                DBMS_OUTPUT.PUT_LINE('TEMOS UM LIMITE DE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO|| ' PRODUTOS');
            END IF;

ELSIF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND

         P_ID_PRODUTO = 6 THEN
            IF P_QUANTIDADE_PEDIDO > 2 THEN
                DBMS_OUTPUT.PUT_LINE('TEMOS UM LIMITE DE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO|| ' PRODUTOS');
            END IF;

ELSIF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND

         P_ID_PRODUTO = 7 THEN
            IF P_QUANTIDADE_PEDIDO > 2 THEN
                DBMS_OUTPUT.PUT_LINE('TEMOS UM LIMITE DE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO|| ' PRODUTOS');
            END IF;

ELSIF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND

         P_ID_PRODUTO = 8 THEN
            IF P_QUANTIDADE_PEDIDO > 1 THEN
                DBMS_OUTPUT.PUT_LINE('TEMOS UM LIMITE DE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO|| ' PRODUTOS');
            END IF;

ELSIF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND

         P_ID_PRODUTO = 9 THEN
            IF P_QUANTIDADE_PEDIDO > 2 THEN
                DBMS_OUTPUT.PUT_LINE('TEMOS UM LIMITE DE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO|| ' PRODUTOS');
            END IF;

ELSIF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND

         P_ID_PRODUTO = 10 THEN
            IF P_QUANTIDADE_PEDIDO > 1 THEN
                DBMS_OUTPUT.PUT_LINE('TEMOS UM LIMITE DE '||V_QUANTIDADE_ESTOQUE||'  '||V_NOME_PRODUTO|| ' PRODUTOS');
            END IF;

ELSIF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND

         P_ID_PRODUTO = 11 THEN
            IF P_QUANTIDADE_PEDIDO > 1 THEN
                DBMS_OUTPUT.PUT_LINE('TEMOS UM LIMITE DE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO|| ' PRODUTOS');
            END IF;

ELSIF V_QUANTIDADE_ESTOQUE >= P_QUANTIDADE_PEDIDO THEN
    DBMS_OUTPUT.PUT_LINE('NOS TEMOS '||P_QUANTIDADE_PEDIDO||' '||V_NOME_PRODUTO||' PARA LOCAR, QUER AGENDAR ?');
END IF;

    IF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND P_ID_PRODUTO = 1 THEN
        IF P_QUANTIDADE_PEDIDO <= 20 THEN    
            IF P_DATA_LOC < V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA TEMOS SOMENTE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO||' PARA ALOCAR, PODE SER ?');
            ELSIF P_DATA_LOC > V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA DE LOCACAO TEREMOS '||P_QUANTIDADE_PEDIDO||' '||V_NOME_PRODUTO||' PARA ALOCAR,');
            ELSE DBMS_OUTPUT.PUT_LINE('PRODUTO EM FALTA');
            END IF;
        END IF;
    END IF;

    IF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND P_ID_PRODUTO = 2 THEN
        IF P_QUANTIDADE_PEDIDO <= 140 THEN    
            IF P_DATA_LOC < V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA TEMOS SOMENTE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO||' PARA ALOCAR, PODE SER ?');
            ELSIF P_DATA_LOC > V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA DE LOCACAO TEREMOS '||P_QUANTIDADE_PEDIDO||' '||V_NOME_PRODUTO||' PARA ALOCAR,');
            ELSE DBMS_OUTPUT.PUT_LINE('PRODUTO EM FALTA');
            END IF;
        END IF;
    END IF;

    IF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND P_ID_PRODUTO = 3 THEN
        IF P_QUANTIDADE_PEDIDO <= 20 THEN    
            IF P_DATA_LOC <= V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA TEMOS SOMENTE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO||' PARA ALOCAR, PODE SER ?');
            ELSIF P_DATA_LOC >= V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA DE LOCACAO TEREMOS '||P_QUANTIDADE_PEDIDO||' '||V_NOME_PRODUTO||' PARA ALOCAR,');
            ELSE DBMS_OUTPUT.PUT_LINE('PRODUTO EM FALTA');
            END IF;
        END IF;
    END IF;

    IF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND P_ID_PRODUTO = 4 THEN
        IF P_QUANTIDADE_PEDIDO <= 2 THEN    
            IF P_DATA_LOC < V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA TEMOS SOMENTE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO||' PARA ALOCAR, PODE SER ?');
            ELSIF P_DATA_LOC > V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA DE LOCACAO TEREMOS '||P_QUANTIDADE_PEDIDO||' '||V_NOME_PRODUTO||' PARA ALOCAR,');
            ELSE DBMS_OUTPUT.PUT_LINE('PRODUTO EM FALTA');
            END IF;
        END IF;
    END IF;

    IF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND P_ID_PRODUTO = 5 THEN
        IF P_QUANTIDADE_PEDIDO <= 3 THEN    
            IF P_DATA_LOC < V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA TEMOS SOMENTE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO||' PARA ALOCAR, PODE SER ?');
            ELSIF P_DATA_LOC > V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA DE LOCACAO TEREMOS '||P_QUANTIDADE_PEDIDO||' '||V_NOME_PRODUTO||' PARA ALOCAR,');
            ELSE DBMS_OUTPUT.PUT_LINE('PRODUTO EM FALTA');            
            END IF;
        END IF;
    END IF;

    IF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND P_ID_PRODUTO = 6 THEN
        IF P_QUANTIDADE_PEDIDO <= 2 THEN    
            IF P_DATA_LOC < V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA TEMOS SOMENTE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO||' PARA ALOCAR, PODE SER ?');
            ELSIF P_DATA_LOC > V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA DE LOCACAO TEREMOS '||P_QUANTIDADE_PEDIDO||' '||V_NOME_PRODUTO||' PARA ALOCAR,');
            ELSE DBMS_OUTPUT.PUT_LINE('PRODUTO EM FALTA');
            END IF;
        END IF;
    END IF;

    IF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND P_ID_PRODUTO = 7 THEN
        IF P_QUANTIDADE_PEDIDO <= 2 THEN    
            IF P_DATA_LOC < V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA TEMOS SOMENTE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO||' PARA ALOCAR, PODE SER ?');
            ELSIF P_DATA_LOC > V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA DE LOCACAO TEREMOS '||P_QUANTIDADE_PEDIDO||' '||V_NOME_PRODUTO||' PARA ALOCAR,');
            ELSE DBMS_OUTPUT.PUT_LINE('PRODUTO EM FALTA');            
            END IF;
        END IF;
    END IF;

    IF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND P_ID_PRODUTO = 8 THEN
        IF P_QUANTIDADE_PEDIDO <= 1 THEN    
            IF P_DATA_LOC < V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA TEMOS SOMENTE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO||' PARA ALOCAR, PODE SER ?');
            ELSIF P_DATA_LOC > V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA DE LOCACAO TEREMOS '||P_QUANTIDADE_PEDIDO||' '||V_NOME_PRODUTO||' PARA ALOCAR,');
            ELSE DBMS_OUTPUT.PUT_LINE('PRODUTO EM FALTA');            
            END IF;
        END IF;
    END IF;

    IF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND P_ID_PRODUTO = 9 THEN
        IF P_QUANTIDADE_PEDIDO <= 2 THEN    
            IF P_DATA_LOC < V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA TEMOS SOMENTE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO||' PARA ALOCAR, PODE SER ?');
            ELSIF P_DATA_LOC > V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA DE LOCACAO TEREMOS '||P_QUANTIDADE_PEDIDO||' '||V_NOME_PRODUTO||' PARA ALOCAR,');
            ELSE DBMS_OUTPUT.PUT_LINE('PRODUTO EM FALTA');            
            END IF;
        END IF;
    END IF;

    IF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND P_ID_PRODUTO = 10 THEN
        IF P_QUANTIDADE_PEDIDO <= 1 THEN    
            IF P_DATA_LOC < V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA TEMOS SOMENTE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO||' PARA ALOCAR, PODE SER ?');
            ELSIF P_DATA_LOC > V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA DE LOCACAO TEREMOS '||P_QUANTIDADE_PEDIDO||' '||V_NOME_PRODUTO||' PARA ALOCAR,');
            ELSE DBMS_OUTPUT.PUT_LINE('PRODUTO EM FALTA');            
            END IF;
        END IF;
    END IF;

    IF V_QUANTIDADE_ESTOQUE < P_QUANTIDADE_PEDIDO AND P_ID_PRODUTO = 11 THEN
        IF P_QUANTIDADE_PEDIDO <= 1 THEN    
            IF P_DATA_LOC < V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA TEMOS SOMENTE '||V_QUANTIDADE_ESTOQUE||' '||V_NOME_PRODUTO||' PARA ALOCAR, PODE SER ?');
            ELSIF P_DATA_LOC > V_DATA_DEVOLUCAO AND V_QUANTIDADE_ESTOQUE > 0 THEN
                DBMS_OUTPUT.PUT_LINE('PRA ESSA DATA DE LOCACAO TEREMOS '||P_QUANTIDADE_PEDIDO||' '||V_NOME_PRODUTO||' PARA ALOCAR,');
            ELSE DBMS_OUTPUT.PUT_LINE('PRODUTO EM FALTA');            
            END IF;
        END IF;
    END IF;

    IF V_QUANTIDADE_ESTOQUE < 1 THEN
        DBMS_OUTPUT.PUT_LINE('TEMOS UM LIMITE');
    END IF;
END;

